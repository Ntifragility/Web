---
title: NEMA - Harmonics
subtitle: Power Factor Analysis & Harmonic Distortion Calculations
date: 2025-11-08
image: /vault-harmonics/img/NEMA-Armonicos-1.png
---

Questions:

1. Some electrical tools don't show the angle (only show %) How to find that angle?
2.  What does a *negative harmonic* mean?

Current source:

![[NEMA-Armonicos-1.png| 350]]

PF allows to add IEC 61000 to approiximate harm or effect occurred for a given angle (we can't asusume or invent any angle, because it depends on the system):

If we don't have the angle use IEC 61000!!!

![[NEMA-Armonicos-2.png.png| 350]]

Sometimes PF offers predesigned harmonic models:

![[NEMA-Armonicos-3.png.png| 350]]

![[NEMA-Armonicos-4.png.png| 350]]

![[NEMA-Armonicos-5.png.png| 350]]

The lower the pulses, the higher the harmonics!

## Exercise 1:

There's a 3-ph purely resistive, 50 kW nominal fed straight from a 415 V (LL), 3-ph bar, 60 Hz. When measuring, the load was consuming 41.5 kW and the waveform had:
- 11 V of 5th harmonic with negative sequence
- 8 V of 7th harmonic with positive sequence
Guessing that ==resistance varies proportionally to the root square of the n-th harmonic==, 

$$
R_{nth} = R_1*\sqrt n 
$$
$$
R_1 = \frac{V_{f}^2}{P_{harm}} 
$$
Compute THD and TDD.

### Step1: Compute load resistance in each case

$$
R_1 = \frac{V_f^2}{P_1} 
$$
$$
R_5 = R_1*\sqrt5 = 9.28  \ohm
$$
$$
R_7 = R_1*\sqrt7 = 10.98  \ohm
$$
### Step2: Compute current values

- 1st. Nominal current

$$ I_{LL-rated} = \frac{P_{rated}}{\sqrt3 *V_{LL-rated}} = \frac{50000}{\sqrt3 * 415} = 69.56 A $$

- 2nd. Each harmonic has its own current value.

```python
from sympy import *

# 1. Define symbols
P, V, I = symbols('P V I')
equation = Eq(I, P/V)

# 2. Input values
val_P = 50000  
val_V = 415/sqrt(3) 

# 3. Compute
substituted = equation.subs({P: val_P, V: val_V})
final_value = substituted.rhs.evalf(4)  # Calculate the final decimal result (rounded to 2 decimal places)

# 4. Output (Mathcad Display) ---
print(f"$$ {latex(equation)} $$")   # Print the generic formula

# Print the substitution and the final result
print(f"$$ I = \\frac{{{val_P}}}{{{val_V}}} = {final_value} \\text{{ A}} $$")
```

$$ I = \frac{P}{V} $$ $$ I = \frac{50000}{415*sqrt(3)/3} = 208.7 \text{ A} $$













# Define symbols

P, V = symbols('x y')

  

# Create equation

current = P/V

  

# Solve it

solution = solve(current, P)

  

# Output as LaTeX

print("$$" + latex(current) + " = 0$$")

print("$$x = " + latex(solution) + "$$")

## Total Harmonic Distortion (THD) 






### RMS value

When voltage or current signals are added


## Distortion cofactor (*Cd*) 




## Distortion power (*D*) 

Harmonics generate a fall of power factor

For 1-ph systems:
$$
D = \left( \sqrt{\sum_{h=2}^{\infty} V_h^2} \sqrt{\sum_{h=2}^{\infty} I_h^2}\right) Cd
$$

For 3-ph systems:
$$
D = \left( \sqrt{\sum_{h=2}^{\infty} V_h^2} \sqrt{\sum_{h=2}^{\infty} I_h^2}\right) Cd * \sqrt3
$$




```python
from sympy import *

# Define symbols
x, y = symbols('x y')

# Create equation
equation = x**2 + 2*x + 1

# Solve it
solution = solve(equation, x)

# Output as LaTeX
print("$$" + latex(equation) + " = 0$$")
print("$$x = " + latex(solution) + "$$")
```